<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Query activities by state and event category">
    <title>Query by State and Event Category</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <style>
        :root {
            --bg-color: #fff;
            --text-color: #333;
            --table-bg: #fff;
            --table-border: #dee2e6;
            --btn-primary-bg: #5A2D84;
        }
        [data-theme="dark"] {
            --bg-color: #222;
            --text-color: #ddd;
            --table-bg: #333;
            --table-border: #555;
            --btn-primary-bg: #7a4aa3;
        }
        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: all 0.3s;
        }
        .table {
            background-color: var(--table-bg);
            border-color: var(--table-border);
        }
        .table th, .table td {
            vertical-align: middle;
        }
        .navbar {
            position: sticky;
            top: 0;
            z-index: 1000;
            background-color: var(--bg-color);
            padding: 10px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            border: 0;
        }
        @media (max-width: 768px) {
            .table {
                display: block;
            }
            thead {
                display: none;
            }
            tr {
                display: block;
                margin-bottom: 1em;
                border-bottom: 1px solid var(--table-border);
            }
            td {
                display: block;
                text-align: left;
                padding-left: 50%;
                position: relative;
            }
            td:before {
                content: attr(data-label);
                position: absolute;
                left: 10px;
                width: 45%;
                font-weight: bold;
            }
        }
    </style>
</head>
<body>
<div class="container">
    <nav class="navbar">
        <div class="mb-4">
            <a href="/" class="btn btn-primary" style="background-color: var(--btn-primary-bg)">Back to Home</a>
        </div>
    </nav>
    <h1 class="text-center mt-4" style="font-family: 'Arial', sans-serif; font-size: 40px; color: var(--btn-primary-bg); font-weight: bold; text-shadow: 2px 2px 5px rgba(0,0,0,0.3);">Query by State and Event Category</h1>

    <!-- Query Form -->
    <form th:action="@{/stateCategoryQuery}" method="post" class="row mb-4">
        <div class="col-md-4">
            <select name="state" class="form-control state-select" required>
                <option value="" th:selected="${state == ''}">Select State</option>
                <option value="Andhra Pradesh" th:selected="${state == 'Andhra Pradesh'}">Andhra Pradesh</option>
                <option value="Telangana" th:selected="${state == 'Telangana'}">Telangana</option>
                <option value="Karnataka" th:selected="${state == 'Karnataka'}">Karnataka</option>
            </select>
        </div>
        <div class="col-md-4">
            <select name="eventCategory" class="form-control category-select" required>
                <option value="" th:selected="${eventCategory == ''}">Select Event Category</option>
                <option value="Integrity Pledge" th:selected="${eventCategory == 'Integrity Pledge'}">Integrity Pledge</option>
                <option value="Vendors Meet" th:selected="${eventCategory == 'Vendors Meet'}">Vendors Meet</option>
                <option value="Elocution" th:selected="${eventCategory == 'Elocution'}">Elocution</option>
                <option value="Debate" th:selected="${eventCategory == 'Debate'}">Debate</option>
                <option value="Drawing" th:selected="${eventCategory == 'Drawing'}">Drawing</option>
                <option value="Quiz" th:selected="${eventCategory == 'Quiz'}">Quiz</option>
                <option value="Slogan" th:selected="${eventCategory == 'Slogan'}">Slogan</option>
            </select>
        </div>
        <div class="col-md-4">
            <button type="submit" class="btn btn-primary" style="background-color: var(--btn-primary-bg)">Run Query</button>
        </div>
    </form>

    <!-- Results Table -->
    <table class="table table-bordered table-striped" role="grid" aria-labelledby="activityTableDesc">
        <caption id="activityTableDesc" class="sr-only">List of activities matching state and event category</caption>
        <thead>
            <tr>
                <th scope="col">ID</th>
                <th scope="col">State</th>
                <th scope="col">Station Name</th>
                <th scope="col">Activity Type</th>
                <th scope="col">Event Category</th>
                <th scope="col">Participant Category</th>
                <th scope="col">Event Description</th>
                <th scope="col">School/College/Panchayat Name</th>
                <th scope="col">Event Location</th>
                <th scope="col">Event Date</th>
                <th scope="col">Number of Participants</th>
                <th scope="col">Remarks</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="activity : ${activities}">
                <td data-label="ID" th:text="${activity.id}" scope="row" class="activity-id"></td>
                <td data-label="State" th:text="${activity.state}"></td>
                <td data-label="Station Name" th:text="${activity.stationName}"></td>
                <td data-label="Activity Type" th:text="${activity.activityType}"></td>
                <td data-label="Event Category" th:text="${activity.eventCategory}"></td>
                <td data-label="Participant Category" th:utext="${activity.participantCategory}"></td>
                <td data-label="Event Description" th:utext="${activity.eventDescription}"></td>
                <td data-label="School/College/Panchayat Name" th:text="${activity.schoolOrCollegeOrPanchayatName}"></td>
                <td data-label="Event Location" th:text="${activity.eventLocation}"></td>
                <td data-label="Event Date" th:text="${activity.eventDate}"></td>
                <td data-label="Number of Participants" th:text="${activity.numberOfParticipants}"></td>
                <td data-label="Remarks" th:utext="${activity.remarks}"></td>
            </tr>
            <tr th:unless="${#lists.size(activities) > 0}">
                <td colspan="12" class="text-center">No activities found</td>
            </tr>
        </tbody>
    </table>
</div>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.bundle.min.js" integrity="sha384-pjaaA8dDz/5BgdFUPX6M/9SUZv4d12SUPF0axWc+VRZkx5xU3daN+lYb49+Ax+Tl" crossorigin="anonymous"></script>
<script>
    // Initialize theme from localStorage
    if (localStorage.getItem('theme') === 'dark') {
        document.body.setAttribute('data-theme', 'dark');
    }

    // Initialize Select2 for dropdowns
    $('.state-select, .category-select').select2({
        placeholder: 'Select an option',
        allowClear: true
    });
</script>
</body>
</html>